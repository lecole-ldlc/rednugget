<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nugget Builder</title>
</head>
<body>

<h1>Nugget Builder</h1>

<button type="button" onclick="loadData()">Afficher donn√©es RedNugget</button>
<div id="display"></div>

<script>
function loadData() {
var url="https://docs.google.com/spreadsheets/d/e/2PACX-1vTMpMJUwb0tp1KYel2iu5vQQsvACrgfP7FdAAiFxEUlqk5tkX-HEBI5xcLyocnd5JSemCxMM82Sz1pW/pub?output=csv";
xmlhttp=new XMLHttpRequest();
xmlhttp.onreadystatechange = function() {
if(xmlhttp.readyState == 4 && xmlhttp.status==200){
document.getElementById("display").innerHTML = xmlhttp.responseText;
}
};
xmlhttp.open("GET",url,true);
xmlhttp.send(null);
}s
</script>



<script>
var https = require('https');
var path = require('path');
var fs = require('fs');

var format = 'csv';         // Format you'd like to parse. `tsv` or `csv`
var id = 'GOOGLE_SHEET_ID'; // The Google Sheet ID found in the URL of your Google Sheet.
var sheetId = 0;            // The Page ID of the Sheet you'd like to export. Found as `gid` in the URL.

https.get('https://docs.google.com/spreadsheets/d/e/2PACX-1vTMpMJUwb0tp1KYel2iu5vQQsvACrgfP7FdAAiFxEUlqk5tkX-HEBI5xcLyocnd5JSemCxMM82Sz1pW/export?format=csv', function(resp) {

var body = '';

resp
.on('data', function(data) {

body += ab2str(data);

})
.on('end', function() {

var json = [];
var rows = body.split(/\r\n/i);

for (var i = 0; i < rows.length; i++) {
json.push(rows[i].split(/\t/i));
}

fs.writeFileSync(path.resolve(__dirname, './sheet.json'), JSON.stringify(json));
console.log('Generated sheet.json');

});

});

function ab2str(buf) {
return String.fromCharCode.apply(null, new Uint16Array(buf));
}
</script>













<!-- <script>src="data-rn.js"</script> -->


<!--<script>
var URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTMpMJUwb0tp1KYel2iu5vQQsvACrgfP7FdAAiFxEUlqk5tkX-HEBI5xcLyocnd5JSemCxMM82Sz1pW/pub?output=csv';

console.log("data loaded");
data_full = d3.csvParseRows(textString);
console.log(data_full);

data = []
data_full.forEach(function(line, ind){
if (ind > 0){


o = {
'name': line[0],
'humour': +line[1].replace(",",".")
/*'reflexion'= +line[1].replace(",",".")
'originalite'= +line[1].replace(",",".")
'dureemoyenne'= +line[1].replace(",",".")
'abonnees'= +line[1].replace(",",".")
'frequence'= +line[1].replace(",",".")*/
}
data.push(o);
}
console.log(data);
});
</script>-->


</body>
</html>